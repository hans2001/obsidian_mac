2025-10-01 16:48

Link:

Problem: 
Given a string `s` which represents an expression, _evaluate this expression and return its value_. 

The integer division should truncate toward zero.

You may assume that the given expression is always valid. All intermediate results will be in the range of `[-231, 231 - 1]`.

**Note:** You are not allowed to use any built-in function which evaluates strings as mathematical expressions, such as `eval()`.

**Example 1:**

**Input:** s = "3+2*2"
**Output:** 7

**Example 2:**

**Input:** s = " 3/2 "
**Output:** 1

**Example 3:**

**Input:** s = " 3+5 / 2 "
**Output:** 5

**Constraints:**
- `1 <= s.length <= 3 * 105`
- `s` consists of integers and operators `('+', '-', '*', '/')`separated by some number of spaces.
- `s` represents **a valid expression**.
- All the integers in the expression are non-negative integers in the range `[0, 231 - 1]`.
- The answer is **guaranteed** to fit in a **32-bit integer**.

Intuition:
use stack to hold operand, process last operator when a new operator is encountered, which mean the last operand of previous operation is ready! 

Solution:
```python
class Solution:
    def calculate(self, s: str) -> int:
        sk = []
        nm = 0
        op = '+'               # previous operator (sentinel)
        ops = {'+', '-', '*', '/'}

        def apply(prev_op: str, rhs: int) -> None:
            if prev_op == '+':
                sk.append(rhs)
            elif prev_op == '-':
                sk.append(-rhs)
            elif prev_op == '*':
                if not sk:
                    raise ValueError("Invalid expression: '*' with no left operand")
                sk.append(sk.pop() * rhs)
            elif prev_op == '/':
                if not sk:
                    raise ValueError("Invalid expression: '/' with no left operand")
                a = sk.pop()
                # Truncate toward 0 (Python // floors for negatives, so use int(a / rhs))
                if rhs == 0:
                    raise ZeroDivisionError("division by zero")
                sk.append(int(a / rhs))

        for ch in s:
            if ch == ' ':
                continue

            if ch.isdigit():
                nm = nm * 10 + int(ch)
                continue

            if ch in ops:
                apply(op, nm)
                op = ch
                nm = 0
                continue

            # If we reach here, it's an invalid character
            raise ValueError(f"Invalid character: {ch!r}")

        # Apply the last pending number with the last operator
        apply(op, nm)
        return sum(sk)

```

Tags: #stack 

RL: 

Considerations:
